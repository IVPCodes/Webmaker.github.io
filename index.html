<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>INDOVP Mini Website Hub</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#121212;color:#eee;}
.container{max-width:1000px;margin:0 auto;padding:20px;}
h1{margin-bottom:10px;}
.tabs{display:flex;gap:10px;margin-bottom:20px;}
.tab{padding:8px 12px;background:#2a6cf4;color:white;border:none;border-radius:6px;cursor:pointer;}
.tab.active{background:#1d4bd1;}
.post{background:#222;padding:12px;margin-bottom:10px;border-radius:8px;}
.post h3{margin:0 0 4px;}
.stars{display:flex;gap:4px;margin-top:4px;}
.star{cursor:pointer;color:gold;font-size:18px;}
button.small{padding:4px 6px;font-size:12px;margin-left:4px;}
.owner-btns{margin-top:6px;}
</style>
</head>
<body>
<div class="container">
<h1>INDOVP Mini Website Hub</h1>
<div class="tabs">
<button class="tab active" onclick="switchTab('recent')">Recent</button>
<button class="tab" onclick="switchTab('popular')">Popular</button>
</div>

<div id="recentTab"></div>
<div id="popularTab" style="display:none"></div>

<hr>
<h3>Create New Page</h3>
<label>Title: <input type="text" id="newTitle"></label><br>
<label>HTML Content: <textarea id="newContent" rows="3"></textarea></label><br>
<button onclick="createPage()">Create Page</button>

<p style="margin-top:10px;color:#888;font-size:12px">Sexual or inappropriate content will be deleted</p>
</div>

<script>
let pages=[];
let ownerMode=false;
let konami=[38,38,40,40,37,39,37,39,66,65], kIndex=0;

document.addEventListener('keydown',(e)=>{
  if(e.keyCode===konami[kIndex]){
    kIndex++;
    if(kIndex===konami.length){
      ownerMode=true; 
      kIndex=0; 
      alert('Owner Mode activated!');
      renderTabs(); 
    }
  } else kIndex=0;
});

function switchTab(tab){ 
  document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.tab')[tab==='recent'?0:1].classList.add('active');
  document.getElementById('recentTab').style.display=tab==='recent'?'block':'none';
  document.getElementById('popularTab').style.display=tab==='popular'?'block':'none';
  renderTabs();
}

function createPage(){
  const t=document.getElementById('newTitle').value.trim();
  const c=document.getElementById('newContent').value.trim();
  if(!t||!c){alert('Please enter title and content');return;}
  pages.push({id:Date.now(),title:t,content:c,created:Date.now(),stars:[],author:'User'});
  document.getElementById('newTitle').value=''; 
  document.getElementById('newContent').value='';
  renderTabs();
}

function avgStars(p){ if(!p.stars.length) return 0; return p.stars.reduce((a,b)=>a+b.value,0)/p.stars.length; }

function renderTabs(){
  renderPageList('recentTab',[...pages].sort((a,b)=>b.created-a.created));
  const top5=[...pages].sort((a,b)=>avgStars(b)-avgStars(a)).slice(0,5);
  renderPageList('popularTab',top5);
}

function renderPageList(containerId,list){
  const div=document.getElementById(containerId);
  div.innerHTML='';
  list.forEach(p=>{
    const post=document.createElement('div'); 
    post.className='post';
    post.innerHTML=`<h3>${p.title}</h3><div>${p.content}</div><div class="stars" id="stars-${p.id}"></div><div class="owner-btns" id="owner-${p.id}"></div>`;
    div.appendChild(post);
    renderStars(p);
    renderOwnerBtns(p);
  });
}

function renderStars(p){
  const container=document.getElementById('stars-'+p.id);
  container.innerHTML='';
  for(let i=1;i<=5;i++){
    const star=document.createElement('span');
    star.innerHTML='â˜…';
    star.className='star';
    star.style.opacity=i<=Math.round(avgStars(p))?1:0.3;
    star.onclick=function(){
      if(ownerMode){ p.stars.push({user:'owner',value:i}); }
      else{
        if(p.stars.find(s=>s.user==='me')) return;
        p.stars.push({user:'me',value:i});
      }
      renderTabs();
    };
    container.appendChild(star);
  }
}

function renderOwnerBtns(p){
  const ownerDiv=document.getElementById('owner-'+p.id);
  if(ownerMode){
    const delBtn=document.createElement('button'); 
    delBtn.innerText='Delete'; 
    delBtn.className='small'; 
    delBtn.onclick=function(){ pages=pages.filter(x=>x.id!==p.id); renderTabs(); };
    ownerDiv.innerHTML=''; ownerDiv.appendChild(delBtn);
  }
}

renderTabs();
</script>
</body>
</html>
